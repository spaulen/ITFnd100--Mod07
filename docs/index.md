**Dev:** *SPaulen*  
**Date:** *12.01.2020*  
**GitHub:** <https://github.com/spaulen/IntroToProg-Python-Mod07>  

# Python Pickling Module & Error Handling

## Introduction
The two features introduced this week provide ways to make our Python code more robust and allow us to save/send serialized and deserialized data.  The Pickle module can be imported to Python code in order to save to binary data files or to unpack binary data files.  Error Handling can be done in a few different ways to capture errors and make a program more user-friendly.

## Pickle Module
Using the Pickle Module in Python requires importing Pickle via the command: import Pickle.  This module contains functions to change an object to binary format as well as unpack a binary object to text. 

Some good websites to read about Pickling and Serialization are:  
* <https://medium.com/better-programming/dont-fear-the-pickle-using-pickle-dump-and-pickle-load-5212f23dbbce>
* <https://realpython.com/python-pickle-module/#:~:text=%20The%20Python%20pickle%20module%20basically%20consists%20of,%28bytes_object%2C%20%208%20%2C%20fix_imports%3DTrue%2C%20encoding%3D%22ASCII%22%2C...%20More%20>
* <https://www.geeksforgeeks.org/understanding-python-pickling-example/>
* <https://en.wikipedia.org/wiki/Serialization>

Serialization is most often used to:
1. Detect changes in data over time
2. Transfer data 
3. Store data 
4. Distribute objects

### Part 1: Pickle Dump 
For this assignment, I created a text file called AlpineSki.txt.  
The text file appears like this:

Figure 1  AlpineSki.txt File Content  
<img src=https://github.com/spaulen/ITFnd100--Mod07/blob/main/docs/FIgure1.PNG alt="Figure 1  AlpineSki.txt File Contents" height="200"/>  
  
This is an alpine ski trip packing list. This file will be “pickled” (serialized) into a binary file called: AlpineSki_Pickled.txt when the following method is called from class Processor in the file AlpineSkiing.py:

Figure 2  pickle_to_file method  
<img src=https://github.com/spaulen/ITFnd100--Mod07/blob/main/docs/Figure%202.png alt="Figure 2  pickle_to_file method" height="100"/>  
 
Note that the code uses the pickle function dump to save the list (previously read from AlpineSki.txt) to a file.  

This code is chosen by the user by selecting 1 from the menu of options per the code below.  Note that the arguments lstTable and strPickledFileName (hardcoded to “AlpineSki_Pickled.txt”) are passed to pickle_to_file as the parameters list_of_rows and file_name.

Figure 3 Code Executed If User Chooses Option 1 (Pickle)
 
When the program runs, selecting 1 returns this result:
Figure 4 User Chooses Option 1 (Pickle)
 
The contents of the Pickled File “AlpineSki_Pickled.txt” are:
Figure 5 AlpineSki_Pickled.txt Contents
 
### Part 2: Pickle Load
Any pickled (serialized) file can be unpickled (deserialized) to a list when the following method is called from the class Processor in the file AlpineSkiing.py:
Figure 6  unpickled_from_file method
 
Note that the code uses the pickle function load to save to a list.
This code is chosen by the user by selecting 2 from the menu of options per the code below.  Note that the arguments lstTable and strPickledFileName (hardcoded to “AlpineSki_Pickled.txt”) are passed to unpickled_from_file as the parameters list_of_rows and file_name.
Figure 7 Code Executed If User Chooses Option 2 (Unpickle)
 
When the program runs, selecting 2 returns this result:

Figure 8 User Chooses Option 2 (UnPickle)









	

## Error Handling 
Error Handling in Python can be grouped into the following 4 categories:
1. Try-Except/Try-Except-else Clause
This clause is useful for capturing unknown code problems or issues where a file may not always be available.  
2. Raise Exception with Arguments
Exceptions can be raised anywhere they are needed.  Once an exception has been raised, execution will stop, and the exception will go up the call stack until the exception is handled.
3. Create Custom Exceptions in Python
Custom exceptions are created by the developer in the code as a user defined function or class.  
4. Python Built-in Exceptions
Built-in Exceptions are either generated by the interpreter or built-in functions. They usually have additional information that details an error’s cause such as a code or a description. Examples of built-in exceptions are: FileNotFoundError, ZeroDivisionError and ImportError.
AlpineSki.py makes use of 3 of these error handling methods if anything other than 1, 2 or 3 is entered as an option.
a. If something other than 1, 2 or 3 is entered, the code falls through to the else statement which raises a custom class.
b. The user defined exception InvalidChoice is raised when anything other than 1, 2 or 3 is entered as an option.  This is a custom exception.  Notice that it uses the base Exception class as the parent.  In this way, the user-defined exception class raises exceptions as any other exception class does.

Figure 9 Custom Exception
 
c. Note that the except clause invokes the Exception parent which incorporates the custom exception message returned from InvalidChoice as “e”.
 
Run Time Error Handling in AlpineSki.py:
Figure 7 Run-Time Error Handling of an Invalid Option
 
Some good websites to read about Python Exception Handling are:
• Python Exception Handling: A Quick Tutorial for Learning (techbeamers.com)
• Exception Handling in Python | Pythontic.com
• Python - Exceptions Handling - Tutorialspoint
• Built-in Exceptions — Python 3.9.1rc1 documentation

## Summary
Error Handling is essential in every program but most especially in programs where errors can be expected and even predicted; such as user entry and data formats that can be changed by other systems or developers.

The Pickle Module can be useful for serialization and deserialization within a program.  However, it has security issues so should be used only for internal program purposes and not for deserialization of external binary files. 

### Appendix A - Python Code
` # ---------------------------------------------------------------------------- #  
` # Title: An Alpine Skiing Packing List  
` # Description: Demonstration of Pickling and Exception Handling  
` # ChangeLog: (Who,When,What):  
` # SPaulen, 12/01/2020, Created  
` # ---------------------------------------------------------------------------- #  
` # Import Pickle Module  
` import pickle  

# Declare Variables and Classes
strFileName = "AlpineSki.txt" # The name of the text data file
strPickledFileName = "AlpineSki_Pickled.txt" # The name of the binary data file
lstTable = [] # A list that acts as a 'table' of rows
intChoice = 0 # Captures the user option selection
strStatus = "" # Captures the status of an processing functions


`# Exception
class InvalidChoice(Exception):
    def __str__(self):
        return 'Please enter  1, 2 or 3' + "\n"


`# Processing
class Processor:
    @staticmethod
    def read_data_from_file(file_name, list_of_rows):
        list_of_rows.clear()  # clear current data
        try:
            file = open(file_name, "r")
            for row in file:
                if "\n" in row:
                    row = row.replace("\n", " ")
                list_of_rows.append(row)
            file.close()
            return list_of_rows, "Success"
        except:
            return None, "Success"

    @staticmethod
    def pickle_to_file(list_of_rows, file_name):
        file = open(file_name, 'wb')
        pickle.dump(list_of_rows, file)
        file.close()
        return list_of_rows, "Success"

    @staticmethod
    def unpickled_from_file(list_of_rows, file_name):
        file = open(file_name, "rb")
        list_of_rows = pickle.load(file)
        file.close()
        return list_of_rows, "Success"


# Presentation
class Presentation:
    @staticmethod
    def print_data_from_file(list_of_rows):
        print("******* Alpine Ski Packing List *******")
        for row in list_of_rows:
            print(row)
        print("*******+++++++++++++++++++++++++*******")

    @staticmethod
    def print_menu_tasks():
        print('''
        Menu of Options
        1) Pickle
        2) UnPickle
        3) Exit Program
        ''')


# Main Body
while True:
    try:
        Presentation.print_menu_tasks()
        intChoice = input("> ")
        if intChoice == 1:
            lstTable, strStatus = Processor.read_data_from_file(strFileName, lstTable)
            Presentation.print_data_from_file(lstTable)
            lstTable, strStatus = Processor.pickle_to_file(lstTable, strPickledFileName)
            print(strStatus + ": The File has been Pickled! ")
        elif intChoice == 2:
            lstTable, strStatus = Processor.unpickled_from_file(lstTable, strPickledFileName)
            Presentation.print_data_from_file(lstTable)
            print(strStatus + ": The File has been UnPickled! ")
        elif intChoice == 3:
            print("Goodbye!")
            break
        else:
            raise InvalidChoice()

    except Exception as e:
        print("The Python error message is: ")
        print(e, "\n")
	`
